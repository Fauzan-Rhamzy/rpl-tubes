<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/Booking/bookingStyle.css') }}" />
  <title>Booking Dokter</title>
</head>

<body>
  <div class="container">
    <aside class="sidebar">
      <div class="logo">
        <h1>Klinik SehatBro.</h1>
      </div>
      <nav>
        <ul>
          <li id="nav-homepage">
            <img src="{{ url_for('static', filename='images/Booking/home-gray.png') }}" />
            <a href="{{ url_for('homepage') }}" id="link-homepage">Homepage</a>
          </li>
          <li id="nav-booking">
            <img src="{{ url_for('static', filename='images/Booking/calendar-add-white.png') }}" />
            <a href="#">Booking</a>
          </li>
          <li id="nav-jadwal">
            <img src="{{ url_for('static', filename='images/Booking/calendar-tick-gray.png') }}" />
            <a href="{{ url_for('jadwaltemu') }}">Jadwal Temu</a>
          </li>
          <li id="nav-tagihan">
            <img src="{{ url_for('static', filename='images/Booking/receipt-text.png') }}" />
            <a href="{{ url_for('tagihan') }}">Tagihan</a>
          </li>
          <li id="nav-profile">
            <img src="{{ url_for('static', filename='images/Booking/profile-circle.png') }}" />
            <a href="{{ url_for('profile') }}">Profile</a>
          </li>
          <li id="nav-logout">
            <img src="{{ url_for('static', filename='images/Booking/logout.png') }}" />
            <a href="{{ url_for('login') }}">Logout</a>
          </li>
        </ul>
      </nav>
    </aside>

    <main class="main-content">
      <header>
        <h1>Booking Dokter</h1>
      </header>

      <section id="specialization-selection">
        <h2>Pilih Spesialisasi</h2>
        <select id="specialization" onchange="showDoctors()">
          <option value="" disabled selected>Pilih Spesialisasi</option>
          <option value="gigi">Dokter Gigi</option>
          <option value="mata">Dokter Mata</option>
          <option value="penyakit dalam">Dokter Penyakit Dalam</option>
          <option value="anak">Dokter Anak</option>
        </select>
      </section>

      <section id="doctor-list" style="display:none;">
        <h2>Daftar Dokter</h2>
        <div id="doctors"></div>
      </section>

      <section id="schedule-selection" style="display:none;">
        <h2>Pilih Jadwal</h2>
        <div id="schedule-buttons"></div>
        <button id="booking-btn" onclick="bookAppointment()" style="display:none;">Booking</button>
      </section>
    </main>
  </div>

  <footer>
    <p>&copy; 2024 Klinik SehatBro. | All Rights Reserved</p>
  </footer>

  <script>
    // Data dokter dan jadwal praktik
    const doctorsData = {{ doctors_data | tojson }};

    function showDoctors() {
      const specialization = document.getElementById("specialization").value;
      const doctorList = document.getElementById("doctor-list");
      const doctorsContainer = document.getElementById("doctors");
      const scheduleSection = document.getElementById("schedule-selection");
      const bookingBtn = document.getElementById("booking-btn");

      // Menyembunyikan daftar dokter dan jadwal jika spesialisasi belum dipilih
      if (!specialization) {
        doctorList.style.display = "none";
        scheduleSection.style.display = "none";
        return;
      }

      // Menampilkan daftar dokter berdasarkan spesialisasi
      doctorList.style.display = "block";
      doctorsContainer.innerHTML = ""; // Menghapus daftar dokter sebelumnya
      scheduleSection.style.display = "none"; // Menyembunyikan jadwal

      const doctors = doctorsData[specialization];

      // Menampilkan dokter yang sesuai dengan spesialisasi
      doctors.forEach((doctor) => {
        const doctorCard = document.createElement("div");
        doctorCard.classList.add("doctor-card");

        doctorCard.innerHTML = `
        <h3>${doctor.name}</h3>
        <p>Spesialis: ${doctor.specialization}</p>
        <button onclick="selectSchedule('${doctor.name}')">Pilih Jadwal</button>
        `;

        doctorsContainer.appendChild(doctorCard);
      });
    }

    let selectedDoctor = null;

    function selectSchedule(doctorName) {
      const scheduleSection = document.getElementById("schedule-selection");
      const scheduleButtons = document.getElementById("schedule-buttons");
      const bookingBtn = document.getElementById("booking-btn");

      selectedDoctor = doctorsData[Object.keys(doctorsData).find(key => doctorsData[key].some(d => d.name === doctorName))]
        .find(d => d.name === doctorName);

      // Menampilkan pilihan jadwal untuk dokter yang dipilih
      scheduleSection.style.display = "block";
      scheduleButtons.innerHTML = ""; // Menghapus tombol jadwal sebelumnya
      bookingBtn.style.display = "none"; // Sembunyikan tombol booking sampai jadwal dipilih

      // Membuat tombol untuk setiap jadwal
      selectedDoctor.schedule.forEach((schedule) => {
        const scheduleButton = document.createElement("button");
        scheduleButton.textContent = schedule;
        scheduleButton.onclick = function () {
          selectTimeSlot(schedule);
        };
        scheduleButtons.appendChild(scheduleButton);
      });
    }

    let selectedSchedule = null;

    function selectTimeSlot(schedule) {
      selectedSchedule = schedule;
      document.getElementById("booking-btn").style.display = "inline-block"; // Menampilkan tombol booking
    }

    function bookAppointment() {
      alert("Anda berhasil melakukan booking dengan ${selectedDoctor.name} pada jadwal ${selectedSchedule}.");
      // Data booking dapat dikirim ke server di sini
    }
  </script>
</body>

</html>